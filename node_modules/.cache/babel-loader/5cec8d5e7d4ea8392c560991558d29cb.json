{"remainingRequest":"/Users/alone/VueProjects/one-piece-vue/node_modules/babel-loader/lib/index.js!/Users/alone/VueProjects/one-piece-vue/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/alone/VueProjects/one-piece-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/alone/VueProjects/one-piece-vue/src/views/permission/user/Index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/alone/VueProjects/one-piece-vue/src/views/permission/user/Index.vue","mtime":1597413533825},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/cache-loader/dist/cjs.js","mtime":1595422850119},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/babel-loader/lib/index.js","mtime":1595422850086},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/cache-loader/dist/cjs.js","mtime":1595422850119},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/vue-loader/lib/index.js","mtime":1596109940102}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCB7IFNUYWJsZSB9IGZyb20gJ0AvY29tcG9uZW50cyc7CmltcG9ydCBVc2VyRm9ybSBmcm9tICcuL2NvbXBvbmVudHMvVXNlckZvcm0nOwppbXBvcnQgeyBmZXRjaEFjY291bnQsIGRlbGV0ZUFjY291bnQsIGNyZWF0ZUFjY291bnQsIHVwZGF0ZUFjY291bnQgfSBmcm9tICdAL2FwaS9hZG1pbic7CnZhciBjb2x1bW5zID0gW3sKICB0aXRsZTogJ+i0puWPt+WQjScsCiAgZGF0YUluZGV4OiAnbmlja25hbWUnCn0sIHsKICB0aXRsZTogJ+eZu+W9lei0puWPtycsCiAgZGF0YUluZGV4OiAnYWNjb3VudCcKfSwgewogIHRpdGxlOiAn54q25oCBJywKICBzY29wZWRTbG90czogewogICAgY3VzdG9tUmVuZGVyOiAnc3RhdHVzJwogIH0KfSwgewogIHRpdGxlOiAn5pu05paw5pe26Ze0JywKICBkYXRhSW5kZXg6ICd1cGRhdGVkX2F0Jwp9LCB7CiAgdGl0bGU6ICfliJvlu7rml7bpl7QnLAogIGRhdGFJbmRleDogJ2NyZWF0ZWRfYXQnCn0sIHsKICB0aXRsZTogJ+aTjeS9nCcsCiAgc2NvcGVkU2xvdHM6IHsKICAgIGN1c3RvbVJlbmRlcjogJ3Rvb2xzJwogIH0KfV07CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICByZXR1cm4gewogICAgICBkZXNjcmlwdGlvbjogJ+WQjuWPsOeuoeeQhui0puWPt+WIl+ihqCcsCiAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICB1c2VyRnJvbVZpc2libGU6IGZhbHNlLAogICAgICBjb25maXJtTG9hZGluZzogZmFsc2UsCiAgICAgIHJ1bGVzOiBbXSwKICAgICAgcm9sZXM6IFtdLAogICAgICBjb2x1bW5zOiBjb2x1bW5zLAogICAgICBzZWxlY3RlSWQ6IDAsCiAgICAgIGxvYWREYXRhOiBmdW5jdGlvbiBsb2FkRGF0YShwYXJhbWV0ZXIpIHsKICAgICAgICByZXR1cm4gZmV0Y2hBY2NvdW50KCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICB2YXIgX3JlcyRkYXRhID0gcmVzLmRhdGEsCiAgICAgICAgICAgICAgdXNlcnMgPSBfcmVzJGRhdGEudXNlcnMsCiAgICAgICAgICAgICAgcnVsZXMgPSBfcmVzJGRhdGEucnVsZXMsCiAgICAgICAgICAgICAgcm9sZXMgPSBfcmVzJGRhdGEucm9sZXM7CiAgICAgICAgICBfdGhpcy5ydWxlcyA9IHJ1bGVzOwogICAgICAgICAgX3RoaXMucm9sZXMgPSByb2xlczsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGRhdGE6IHVzZXJzCiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICB9CiAgICB9OwogIH0sCiAgY29tcG9uZW50czogewogICAgU1RhYmxlOiBTVGFibGUsCiAgICBVc2VyRm9ybTogVXNlckZvcm0KICB9LAogIG1ldGhvZHM6IHsKICAgIHJlZnJlc2hUYWJsZTogZnVuY3Rpb24gcmVmcmVzaFRhYmxlKCkgewogICAgICB2YXIgYm9vbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7CiAgICAgIHRoaXMuJHJlZnMudGFibGUucmVmcmVzaChib29sKTsKICAgIH0sCiAgICBzaG93RGVsZXRlQ29uZmlybTogZnVuY3Rpb24gc2hvd0RlbGV0ZUNvbmZpcm0oaWQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLiRjb25maXJtKHsKICAgICAgICB0aXRsZTogJ+ehruWumuWIoOmZpOatpOeUqOaIt+WQlz8nLAogICAgICAgIGNvbnRlbnQ6ICcnLAogICAgICAgIG9rVGV4dDogJ+ehruWumicsCiAgICAgICAgb2tUeXBlOiAnZGFuZ2VyJywKICAgICAgICBjYW5jZWxUZXh0OiAn5Y+W5raIJywKICAgICAgICBvbk9rOiBmdW5jdGlvbiBvbk9rKCkgewogICAgICAgICAgdmFyIGhpZGUgPSBfdGhpczIuJG1lc3NhZ2UubG9hZGluZygn5Yig6Zmk5LitLi4nLCAwKTsKCiAgICAgICAgICBkZWxldGVBY2NvdW50KGlkKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgX3RoaXMyLiRtZXNzYWdlLnN1Y2Nlc3MoJ+WIoOmZpOaIkOWKn++8gScpOwoKICAgICAgICAgICAgX3RoaXMyLnJlZnJlc2hUYWJsZSgpOwogICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGhpZGUoKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlVXNlckNhbmNlbDogZnVuY3Rpb24gaGFuZGxlVXNlckNhbmNlbCgpIHsKICAgICAgdGhpcy51c2VyRnJvbVZpc2libGUgPSBmYWxzZTsKICAgICAgdGhpcy4kcmVmcy51c2VyRm9ybS5mb3JtLnJlc2V0RmllbGRzKCk7CiAgICAgIHRoaXMuc2VsZWN0ZWRJZCA9IDA7CiAgICB9LAogICAgaGFuZGxlVXNlclN1Ym1pdDogZnVuY3Rpb24gaGFuZGxlVXNlclN1Ym1pdCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB0aGlzLiRyZWZzLnJvbGVGb3JtLmZvcm0udmFsaWRhdGVGaWVsZHMoZnVuY3Rpb24gKGVyciwgdmFsdWVzKSB7CiAgICAgICAgaWYgKCFlcnIpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKHZhbHVlcyk7CiAgICAgICAgICBfdGhpczMuc2VsZWN0ZWRJZCA9PT0gMCA/IGNyZWF0ZUFjY291bnQodmFsdWVzKSA6IHVwZGF0ZUFjY291bnQoX3RoaXMzLnNlbGVjdGVkSWQsIHZhbHVlcyk7IC8vICAgICB0aGlzLmNvbmZpcm1Mb2FkaW5nID0gdHJ1ZQogICAgICAgICAgLy8gICAgIGNvbnN0IGhpZGUgPSB0aGlzLiRtZXNzYWdlLmxvYWRpbmcoJ+aJp+ihjOS4rS4uJywgMCkKICAgICAgICAgIC8vICAgICBwcm9taXNlLnRoZW4ocmVzID0+IHsKICAgICAgICAgIC8vICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHRoaXMuc2VsZWN0ZWRJZCA9PT0gMCA/ICfmt7vliqDmiJDlip/vvIEnIDogJ+abtOaWsOaIkOWKn++8gScpCiAgICAgICAgICAvLyAgICAgICAgIHRoaXMuaGFuZGxlUm9sZUNhbmNlbCgpCiAgICAgICAgICAvLyAgICAgICAgIHRoaXMucmVmcmVzaFRhYmxlKCkKICAgICAgICAgIC8vICAgICB9KS5maW5hbGx5KCgpID0+IHsKICAgICAgICAgIC8vICAgICAgICAgaGlkZSgpCiAgICAgICAgICAvLyAgICAgICAgIHRoaXMuY29uZmlybUxvYWRpbmcgPSBmYWxzZQogICAgICAgICAgLy8gICAgIH0pCiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBleHBhbmRJY29uOiBmdW5jdGlvbiBleHBhbmRJY29uKF9yZWYpIHsKICAgICAgdmFyIGV4cGFuZGVkID0gX3JlZi5leHBhbmRlZDsKICAgICAgdmFyIGggPSB0aGlzLiRjcmVhdGVFbGVtZW50OwoKICAgICAgaWYgKGV4cGFuZGVkID09PSB0cnVlKSB7CiAgICAgICAgcmV0dXJuIGgoImEtaWNvbiIsIHsKICAgICAgICAgICJhdHRycyI6IHsKICAgICAgICAgICAgInR5cGUiOiAnZG93bicKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIGgoImEtaWNvbiIsIHsKICAgICAgICAiYXR0cnMiOiB7CiAgICAgICAgICAidHlwZSI6ICdyaWdodCcKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["Index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n<page-header-wrapper :content=\"description\">\n\n    <a-card :body-style=\"{ padding: 0 }\">\n        <div class=\"table-operator-right\">\n            <a-button type=\"primary\" icon=\"plus\" @click=\"userFromVisible = true\">新建</a-button>\n            <a-divider type=\"vertical\"/>\n            <span class=\"ant-pro-table-toolbar-item-icon\">\n                <a-tooltip placement=\"top\">\n                <template slot=\"title\">\n                    <span>刷新</span>\n                </template>\n                <a-icon type=\"reload\" @click=\"refreshTable()\"/>\n                </a-tooltip>\n            </span>\n        </div>\n\n        <s-table\n          ref=\"table\"\n          size=\"default\"\n          :rowKey=\"(record) => record.id\"\n          :columns=\"columns\"\n          :data=\"loadData\"\n          :expandRowByClick=\"true\"\n          :showPagination=\"false\"\n          :expandIcon=\"expandIcon\"\n        >\n\n          <template slot=\"status\" slot-scope=\"row\">\n            <template v-if=\"row.status === 1\">\n              <a-badge status=\"processing\" text=\"启用中\"/>\n            </template>\n            <template v-else>\n              <a-badge status=\"default\" text=\"禁用中\"/>\n            </template>\n          </template>\n\n          <template slot=\"expandedRowRender\" slot-scope=\"row\">\n            <a-row>\n              <a-col class=\"rule-list\" span=\"12\" v-for=\"(item, index) in rules\" :key=\"index\">\n                <a-row>\n                  <a-col span=\"4\">{{ item.title }}：</a-col>\n                  <a-col span=\"20\">\n                    <template v-if=\"!item.actions.length\">-</template>\n                    <template v-for=\"(action, i) in item.actions\">\n                      <a-tag :key=\"i\" v-if=\"row.rules.indexOf(action.id) !== -1\">{{ action.title }}</a-tag>\n                    </template>\n                  </a-col>\n                </a-row>\n              </a-col>\n            </a-row>\n          </template>\n\n          <template slot=\"tools\" slot-scope=\"row\">\n            <a\n              @click=\"$router.push({ name: 'UpdateAccountView', params: { id: row.id } })\"\n            >编辑</a>\n            <a-divider type=\"vertical\" />\n            <a @click=\"showDeleteConfirm(row.id)\">删除</a>\n          </template>\n        </s-table>\n\n    </a-card>\n\n    <userForm\n        ref=\"userForm\"\n        :rules=\"rules\"\n        :roles=\"roles\"\n        :visible=\"userFromVisible\"\n        :confirmLoading=\"confirmLoading\"\n        @submit=\"handleUserSubmit\"\n        @cancel=\"handleUserCancel\"\n    />\n\n</page-header-wrapper>\n</template>\n\n<script>\nimport { STable } from '@/components'\nimport UserForm from './components/UserForm'\nimport { fetchAccount, deleteAccount, createAccount, updateAccount } from '@/api/admin'\nconst columns = [\n  {\n    title: '账号名',\n    dataIndex: 'nickname'\n  },\n  {\n    title: '登录账号',\n    dataIndex: 'account'\n  },\n  {\n    title: '状态',\n    scopedSlots: { customRender: 'status' }\n  },\n  {\n    title: '更新时间',\n    dataIndex: 'updated_at'\n  },\n  {\n    title: '创建时间',\n    dataIndex: 'created_at'\n  },\n  {\n    title: '操作',\n    scopedSlots: { customRender: 'tools' }\n  }\n]\n\nexport default {\n  data () {\n    return {\n      description: '后台管理账号列表',\n      visible: false,\n      userFromVisible: false,\n      confirmLoading: false,\n      rules: [],\n      roles: [],\n      columns,\n      selecteId: 0,\n      loadData: parameter => {\n        return fetchAccount().then(res => {\n          const { users, rules, roles } = res.data\n          this.rules = rules\n          this.roles = roles\n          return {\n              data: users\n          }\n        })\n      }\n    }\n  },\n  components: { STable, UserForm },\n  methods: {\n    refreshTable (bool = false) {\n      this.$refs.table.refresh(bool)\n    },\n    showDeleteConfirm (id) {\n      this.$confirm({\n        title: '确定删除此用户吗?',\n        content: '',\n        okText: '确定',\n        okType: 'danger',\n        cancelText: '取消',\n        onOk: () => {\n          const hide = this.$message.loading('删除中..', 0)\n          deleteAccount(id).then(res => {\n            this.$message.success('删除成功！')\n            this.refreshTable()\n          }).finally(() => {\n            hide()\n          })\n        }\n      })\n    },\n    handleUserCancel() {\n        this.userFromVisible = false\n        this.$refs.userForm.form.resetFields()\n        this.selectedId = 0\n    },\n    handleUserSubmit() {\n        this.$refs.roleForm.form.validateFields((err, values) => {\n            if (!err) {\n            console.log(values)\n            this.selectedId === 0 ? createAccount(values) : updateAccount(this.selectedId, values)\n            //     this.confirmLoading = true\n            //     const hide = this.$message.loading('执行中..', 0)\n            //     promise.then(res => {\n            //         this.$message.success(this.selectedId === 0 ? '添加成功！' : '更新成功！')\n            //         this.handleRoleCancel()\n            //         this.refreshTable()\n            //     }).finally(() => {\n            //         hide()\n            //         this.confirmLoading = false\n            //     })\n            }\n        })\n    },\n\n    expandIcon ({ expanded }) {\n      if (expanded === true) {\n        return <a-icon type='down' />\n      }\n      return <a-icon type='right' />\n    }\n  }\n}\n</script>\n\n<style lang=\"less\">\n\n</style>\n"],"sourceRoot":"src/views/permission/user"}]}