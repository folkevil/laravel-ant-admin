{"remainingRequest":"/Users/alone/VueProjects/one-piece-vue/node_modules/babel-loader/lib/index.js!/Users/alone/VueProjects/one-piece-vue/node_modules/eslint-loader/index.js??ref--13-0!/Users/alone/VueProjects/one-piece-vue/src/store/modules/user.js","dependencies":[{"path":"/Users/alone/VueProjects/one-piece-vue/src/store/modules/user.js","mtime":1597672374936},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/cache-loader/dist/cjs.js","mtime":1595422850119},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/babel-loader/lib/index.js","mtime":1595422850086},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/eslint-loader/index.js","mtime":1595422972371}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgc3RvcmFnZSBmcm9tICdzdG9yZSc7CmltcG9ydCB7IGxvZ2luLCBsb2dvdXQsIGdldEluZm8gfSBmcm9tICdAL2FwaS9sb2dpbic7CmltcG9ydCB7IEFDQ0VTU19UT0tFTiB9IGZyb20gJ0Avc3RvcmUvbXV0YXRpb24tdHlwZXMnOwppbXBvcnQgeyB3ZWxjb21lIH0gZnJvbSAnQC91dGlscy91dGlsJzsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwp2YXIgdXNlciA9IHsKICBzdGF0ZTogewogICAgdG9rZW46ICcnLAogICAgbmFtZTogJycsCiAgICB3ZWxjb21lOiAnJywKICAgIGF2YXRhcjogJycsCiAgICByb2xlczogW10sCiAgICBpbmZvOiB7fSwKICAgIHBlcm1pc3Npb25zOiBbXQogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBTRVRfVE9LRU46IGZ1bmN0aW9uIFNFVF9UT0tFTihzdGF0ZSwgdG9rZW4pIHsKICAgICAgc3RhdGUudG9rZW4gPSB0b2tlbjsKICAgIH0sCiAgICBTRVRfTkFNRTogZnVuY3Rpb24gU0VUX05BTUUoc3RhdGUsIG5hbWUpIHsKICAgICAgc3RhdGUubmFtZSA9IG5hbWU7CiAgICB9LAogICAgU0VUX0FWQVRBUjogZnVuY3Rpb24gU0VUX0FWQVRBUihzdGF0ZSwgYXZhdGFyKSB7CiAgICAgIHN0YXRlLmF2YXRhciA9IGF2YXRhcjsKICAgIH0sCiAgICBTRVRfUk9MRVM6IGZ1bmN0aW9uIFNFVF9ST0xFUyhzdGF0ZSwgcm9sZXMpIHsKICAgICAgc3RhdGUucm9sZXMgPSByb2xlczsKICAgIH0sCiAgICBTRVRfUEVSTUlTU0lPTlM6IGZ1bmN0aW9uIFNFVF9QRVJNSVNTSU9OUyhzdGF0ZSwgcGVybWlzc2lvbnMpIHsKICAgICAgc3RhdGUucGVybWlzc2lvbnMgPSBwZXJtaXNzaW9uczsKICAgIH0sCiAgICBTRVRfV0VMQ09NRTogZnVuY3Rpb24gU0VUX1dFTENPTUUoc3RhdGUsIHdlbGNvbWUpIHsKICAgICAgc3RhdGUud2VsY29tZSA9IHdlbGNvbWU7CiAgICB9LAogICAgU0VUX0lORk86IGZ1bmN0aW9uIFNFVF9JTkZPKHN0YXRlLCBpbmZvKSB7CiAgICAgIHN0YXRlLmluZm8gPSBpbmZvOwogICAgfQogIH0sCiAgYWN0aW9uczogewogICAgLy8g55m75b2VCiAgICBMb2dpbjogZnVuY3Rpb24gTG9naW4oX3JlZiwgdXNlckluZm8pIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIGxvZ2luKHVzZXJJbmZvKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgdmFyIHJlc3VsdCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICBzdG9yYWdlLnNldChBQ0NFU1NfVE9LRU4sIHJlc3VsdC5hY2Nlc3NfdG9rZW4sIHJlc3VsdC5leHBpcmVzX2luKTsKICAgICAgICAgIGNvbW1pdCgnU0VUX1RPS0VOJywgcmVzdWx0LmFjY2Vzc190b2tlbik7CiAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDojrflj5bnlKjmiLfkv6Hmga8KICAgIEdldEluZm86IGZ1bmN0aW9uIEdldEluZm8oX3JlZjIpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYyLmNvbW1pdDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICBnZXRJbmZvKCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIHZhciByZXN1bHQgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICAgIGlmIChyZXN1bHQucGVybWlzc2lvbnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICB2YXIgcGVybWlzc2lvbnMgPSByZXN1bHQucGVybWlzc2lvbnM7CiAgICAgICAgICAgIHBlcm1pc3Npb25zID0gcGVybWlzc2lvbnMubWFwKGZ1bmN0aW9uIChwZXIpIHsKICAgICAgICAgICAgICBpZiAocGVyLmFjdGlvbkVudGl0eVNldCAhPSBudWxsICYmIHBlci5hY3Rpb25FbnRpdHlTZXQubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHBlci5hY3Rpb25FbnRpdHlTZXQubWFwKGZ1bmN0aW9uIChhY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbi5hY3Rpb247CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHBlci5hY3Rpb25MaXN0ID0gYWN0aW9uOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIHBlcjsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbW1pdCgnU0VUX1BFUk1JU1NJT05TJywgcGVybWlzc2lvbnMpOwogICAgICAgICAgICBjb21taXQoJ1NFVF9ST0xFUycsIHJlc3VsdC5yb2xlcyk7CiAgICAgICAgICAgIGNvbW1pdCgnU0VUX0lORk8nLCByZXN1bHQpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignZ2V0SW5mbzogcGVybWlzc2lvbnMgbXVzdCBiZSBhIG5vbi1udWxsIGFycmF5ICEnKSk7CiAgICAgICAgICB9CgogICAgICAgICAgY29tbWl0KCdTRVRfTkFNRScsIHJlc3VsdC5uaWNrbmFtZSk7CiAgICAgICAgICBjb21taXQoJ1NFVF9XRUxDT01FJywgd2VsY29tZSgpKTsKICAgICAgICAgIGNvbW1pdCgnU0VUX0FWQVRBUicsIHJlc3VsdC5hdmF0YXIpOwogICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDnmbvlh7oKICAgIExvZ291dDogZnVuY3Rpb24gTG9nb3V0KF9yZWYzKSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmMy5jb21taXQ7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgIGxvZ291dCgpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgcmVzb2x2ZShlcnJvcik7CiAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7CiAgICAgICAgICBjb21taXQoJ1NFVF9UT0tFTicsICcnKTsKICAgICAgICAgIGNvbW1pdCgnU0VUX1JPTEVTJywgW10pOwogICAgICAgICAgY29tbWl0KCdTRVRfUEVSTUlTU0lPTlMnLCBbXSk7CiAgICAgICAgICBzdG9yYWdlLnJlbW92ZShBQ0NFU1NfVE9LRU4pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9Cn07CmV4cG9ydCBkZWZhdWx0IHVzZXI7"},{"version":3,"sources":["/Users/alone/VueProjects/one-piece-vue/src/store/modules/user.js"],"names":["storage","login","logout","getInfo","ACCESS_TOKEN","welcome","Vue","user","state","token","name","avatar","roles","info","permissions","mutations","SET_TOKEN","SET_NAME","SET_AVATAR","SET_ROLES","SET_PERMISSIONS","SET_WELCOME","SET_INFO","actions","Login","userInfo","commit","Promise","resolve","reject","then","response","result","data","set","access_token","expires_in","catch","error","GetInfo","length","map","per","actionEntitySet","action","actionList","Error","nickname","Logout","finally","remove"],"mappings":"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","sourcesContent":["import storage from 'store'\nimport {\n    login,\n    logout,\n    getInfo\n} from '@/api/login'\nimport {\n    ACCESS_TOKEN\n} from '@/store/mutation-types'\nimport {\n    welcome\n} from '@/utils/util'\nimport Vue from 'vue'\n\nconst user = {\n    state: {\n        token: '',\n        name: '',\n        welcome: '',\n        avatar: '',\n        roles: [],\n        info: {},\n        permissions: []\n    },\n\n    mutations: {\n        SET_TOKEN: (state, token) => {\n            state.token = token\n        },\n        SET_NAME: (state, name) => {\n            state.name = name\n        },\n        SET_AVATAR: (state, avatar) => {\n            state.avatar = avatar\n        },\n        SET_ROLES: (state, roles) => {\n            state.roles = roles\n        },\n        SET_PERMISSIONS: (state, permissions) => {\n            state.permissions = permissions\n        },\n        SET_WELCOME: (state, welcome) => {\n            state.welcome = welcome\n        },\n        SET_INFO: (state, info) => {\n            state.info = info\n        }\n    },\n\n    actions: {\n        // 登录\n        Login({\n            commit\n        }, userInfo) {\n            return new Promise((resolve, reject) => {\n                login(userInfo)\n                    .then(response => {\n                        const result = response.data\n                        storage.set(ACCESS_TOKEN, result.access_token, result.expires_in)\n                        commit('SET_TOKEN', result.access_token)\n                        resolve()\n                    })\n                    .catch(error => {\n                        reject(error)\n                    })\n            })\n        },\n\n        // 获取用户信息\n        GetInfo({\n            commit\n        }) {\n            return new Promise((resolve, reject) => {\n                getInfo()\n                    .then(response => {\n                        const result = response.data\n\n                        if (result.permissions.length > 0) {\n                            let permissions = result.permissions\n\n                            permissions = permissions.map(per => {\n                                if (per.actionEntitySet != null && per.actionEntitySet.length > 0) {\n                                    const action = per.actionEntitySet.map(action => {\n                                        return action.action\n                                    })\n                                    per.actionList = action\n                                }\n                                return per\n                            })\n\n                            commit('SET_PERMISSIONS', permissions)\n                            commit('SET_ROLES', result.roles)\n                            commit('SET_INFO', result)\n                        } else {\n                            reject(new Error('getInfo: permissions must be a non-null array !'))\n                        }\n\n                        commit('SET_NAME', result.nickname)\n                        commit('SET_WELCOME', welcome())\n                        commit('SET_AVATAR', result.avatar)\n\n                        resolve(response)\n                    })\n                    .catch(error => {\n                        reject(error)\n                    })\n            })\n        },\n\n        // 登出\n        Logout({\n            commit\n        }) {\n            return new Promise(resolve => {\n                logout()\n                    .then(() => {\n                        resolve()\n                    })\n                    .catch((error) => {\n                        resolve(error)\n                    })\n                    .finally(() => {\n                        commit('SET_TOKEN', '')\n                        commit('SET_ROLES', [])\n                        commit('SET_PERMISSIONS', [])\n                        storage.remove(ACCESS_TOKEN)\n                    })\n            })\n        }\n    }\n}\n\nexport default user\n"]}]}