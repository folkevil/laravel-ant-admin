{"remainingRequest":"/Users/alone/VueProjects/gold-vue/node_modules/babel-loader/lib/index.js!/Users/alone/VueProjects/gold-vue/node_modules/eslint-loader/index.js??ref--13-0!/Users/alone/VueProjects/gold-vue/src/store/modules/user.js","dependencies":[{"path":"/Users/alone/VueProjects/gold-vue/src/store/modules/user.js","mtime":1590062820801},{"path":"/Users/alone/VueProjects/gold-vue/node_modules/cache-loader/dist/cjs.js","mtime":1589980412065},{"path":"/Users/alone/VueProjects/gold-vue/node_modules/babel-loader/lib/index.js","mtime":1589980411957},{"path":"/Users/alone/VueProjects/gold-vue/node_modules/eslint-loader/index.js","mtime":1589980483701}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgc3RvcmFnZSBmcm9tICdzdG9yZSc7CmltcG9ydCB7IGxvZ2luLCBnZXRJbmZvIH0gZnJvbSAnQC9hcGkvbG9naW4nOwppbXBvcnQgeyBBQ0NFU1NfVE9LRU4gfSBmcm9tICdAL3N0b3JlL211dGF0aW9uLXR5cGVzJzsKaW1wb3J0IHsgd2VsY29tZSB9IGZyb20gJ0AvdXRpbHMvdXRpbCc7CnZhciB1c2VyID0gewogIHN0YXRlOiB7CiAgICB0b2tlbjogJycsCiAgICBuYW1lOiAnJywKICAgIHdlbGNvbWU6ICcnLAogICAgYXZhdGFyOiAnJywKICAgIHJvbGVzOiBbXSwKICAgIGluZm86IHt9CiAgfSwKICBtdXRhdGlvbnM6IHsKICAgIFNFVF9UT0tFTjogZnVuY3Rpb24gU0VUX1RPS0VOKHN0YXRlLCB0b2tlbikgewogICAgICBzdGF0ZS50b2tlbiA9IHRva2VuOwogICAgfSwKICAgIFNFVF9OQU1FOiBmdW5jdGlvbiBTRVRfTkFNRShzdGF0ZSwgX3JlZikgewogICAgICB2YXIgbmFtZSA9IF9yZWYubmFtZSwKICAgICAgICAgIHdlbGNvbWUgPSBfcmVmLndlbGNvbWU7CiAgICAgIHN0YXRlLm5hbWUgPSBuYW1lOwogICAgICBzdGF0ZS53ZWxjb21lID0gd2VsY29tZTsKICAgIH0sCiAgICBTRVRfQVZBVEFSOiBmdW5jdGlvbiBTRVRfQVZBVEFSKHN0YXRlLCBhdmF0YXIpIHsKICAgICAgc3RhdGUuYXZhdGFyID0gYXZhdGFyOwogICAgfSwKICAgIFNFVF9ST0xFUzogZnVuY3Rpb24gU0VUX1JPTEVTKHN0YXRlLCByb2xlcykgewogICAgICBzdGF0ZS5yb2xlcyA9IHJvbGVzOwogICAgfSwKICAgIFNFVF9JTkZPOiBmdW5jdGlvbiBTRVRfSU5GTyhzdGF0ZSwgaW5mbykgewogICAgICBzdGF0ZS5pbmZvID0gaW5mbzsKICAgIH0KICB9LAogIGFjdGlvbnM6IHsKICAgIC8vIOeZu+W9lQogICAgTG9naW46IGZ1bmN0aW9uIExvZ2luKF9yZWYyLCB1c2VySW5mbykgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjIuY29tbWl0OwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIGxvZ2luKHVzZXJJbmZvKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgdmFyIHJlc3VsdCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICBzdG9yYWdlLnNldChBQ0NFU1NfVE9LRU4sIHJlc3VsdC50b2tlbiwgcmVzdWx0LmV4cGlyZSk7CiAgICAgICAgICBjb21taXQoJ1NFVF9UT0tFTicsIHJlc3VsdC50b2tlbik7CiAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDojrflj5bnlKjmiLfkv6Hmga8KICAgIEdldEluZm86IGZ1bmN0aW9uIEdldEluZm8oX3JlZjMpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYzLmNvbW1pdDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICBnZXRJbmZvKCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIHZhciByZXN1bHQgPSByZXNwb25zZS5yZXN1bHQ7CgogICAgICAgICAgaWYgKHJlc3VsdC5yb2xlICYmIHJlc3VsdC5yb2xlLnBlcm1pc3Npb25zLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgdmFyIHJvbGUgPSByZXN1bHQucm9sZTsKICAgICAgICAgICAgcm9sZS5wZXJtaXNzaW9ucyA9IHJlc3VsdC5yb2xlLnBlcm1pc3Npb25zOwogICAgICAgICAgICByb2xlLnBlcm1pc3Npb25zLm1hcChmdW5jdGlvbiAocGVyKSB7CiAgICAgICAgICAgICAgaWYgKHBlci5hY3Rpb25FbnRpdHlTZXQgIT0gbnVsbCAmJiBwZXIuYWN0aW9uRW50aXR5U2V0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSBwZXIuYWN0aW9uRW50aXR5U2V0Lm1hcChmdW5jdGlvbiAoYWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb24uYWN0aW9uOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBwZXIuYWN0aW9uTGlzdCA9IGFjdGlvbjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByb2xlLnBlcm1pc3Npb25MaXN0ID0gcm9sZS5wZXJtaXNzaW9ucy5tYXAoZnVuY3Rpb24gKHBlcm1pc3Npb24pIHsKICAgICAgICAgICAgICByZXR1cm4gcGVybWlzc2lvbi5wZXJtaXNzaW9uSWQ7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjb21taXQoJ1NFVF9ST0xFUycsIHJlc3VsdC5yb2xlKTsKICAgICAgICAgICAgY29tbWl0KCdTRVRfSU5GTycsIHJlc3VsdCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdnZXRJbmZvOiByb2xlcyBtdXN0IGJlIGEgbm9uLW51bGwgYXJyYXkgIScpKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb21taXQoJ1NFVF9OQU1FJywgewogICAgICAgICAgICBuYW1lOiByZXN1bHQubmFtZSwKICAgICAgICAgICAgd2VsY29tZTogd2VsY29tZSgpCiAgICAgICAgICB9KTsKICAgICAgICAgIGNvbW1pdCgnU0VUX0FWQVRBUicsIHJlc3VsdC5hdmF0YXIpOwogICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDnmbvlh7oKICAgIC8vIExvZ291dCAoeyBjb21taXQsIHN0YXRlIH0pIHsKICAgIC8vICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgLy8gICAgIGxvZ291dChzdGF0ZS50b2tlbikKICAgIC8vICAgICAgIC50aGVuKCgpID0+IHsKICAgIC8vICAgICAgICAgcmVzb2x2ZSgpCiAgICAvLyAgICAgICB9KQogICAgLy8gICAgICAgLmNhdGNoKCgpID0+IHsKICAgIC8vICAgICAgICAgcmVzb2x2ZSgpCiAgICAvLyAgICAgICB9KQogICAgLy8gICAgICAgLmZpbmFsbHkoKCkgPT4gewogICAgLy8gICAgICAgICBjb21taXQoJ1NFVF9UT0tFTicsICcnKQogICAgLy8gICAgICAgICBjb21taXQoJ1NFVF9ST0xFUycsIFtdKQogICAgLy8gICAgICAgICBzdG9yYWdlLnJlbW92ZShBQ0NFU1NfVE9LRU4pCiAgICAvLyAgICAgICB9KQogICAgLy8gICB9KQogICAgLy8gfQogICAgTG9nb3V0OiBmdW5jdGlvbiBMb2dvdXQoX3JlZjQpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWY0LmNvbW1pdDsKICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCAnJyk7CiAgICAgIGNvbW1pdCgnU0VUX1JPTEVTJywgW10pOwogICAgICBzdG9yYWdlLnJlbW92ZShBQ0NFU1NfVE9LRU4pOwogICAgfQogIH0KfTsKZXhwb3J0IGRlZmF1bHQgdXNlcjs="},{"version":3,"sources":["/Users/alone/VueProjects/gold-vue/src/store/modules/user.js"],"names":["storage","login","getInfo","ACCESS_TOKEN","welcome","user","state","token","name","avatar","roles","info","mutations","SET_TOKEN","SET_NAME","SET_AVATAR","SET_ROLES","SET_INFO","actions","Login","userInfo","commit","Promise","resolve","reject","then","response","result","data","set","expire","catch","error","GetInfo","role","permissions","length","map","per","actionEntitySet","action","actionList","permissionList","permission","permissionId","Error","Logout","remove"],"mappings":"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","sourcesContent":["import storage from 'store'\nimport { login, getInfo } from '@/api/login'\nimport { ACCESS_TOKEN } from '@/store/mutation-types'\nimport { welcome } from '@/utils/util'\n\nconst user = {\n  state: {\n    token: '',\n    name: '',\n    welcome: '',\n    avatar: '',\n    roles: [],\n    info: {}\n  },\n\n  mutations: {\n    SET_TOKEN: (state, token) => {\n      state.token = token\n    },\n    SET_NAME: (state, { name, welcome }) => {\n      state.name = name\n      state.welcome = welcome\n    },\n    SET_AVATAR: (state, avatar) => {\n      state.avatar = avatar\n    },\n    SET_ROLES: (state, roles) => {\n      state.roles = roles\n    },\n    SET_INFO: (state, info) => {\n      state.info = info\n    }\n  },\n\n  actions: {\n    // 登录\n    Login ({ commit }, userInfo) {\n      return new Promise((resolve, reject) => {\n        login(userInfo)\n          .then(response => {\n            const result = response.data\n            storage.set(ACCESS_TOKEN, result.token, result.expire)\n            commit('SET_TOKEN', result.token)\n            resolve()\n          })\n          .catch(error => {\n            reject(error)\n          })\n      })\n    },\n\n    // 获取用户信息\n    GetInfo ({ commit }) {\n      return new Promise((resolve, reject) => {\n        getInfo()\n          .then(response => {\n            const result = response.result\n\n            if (result.role && result.role.permissions.length > 0) {\n              const role = result.role\n              role.permissions = result.role.permissions\n              role.permissions.map(per => {\n                if (per.actionEntitySet != null && per.actionEntitySet.length > 0) {\n                  const action = per.actionEntitySet.map(action => {\n                    return action.action\n                  })\n                  per.actionList = action\n                }\n              })\n              role.permissionList = role.permissions.map(permission => {\n                return permission.permissionId\n              })\n              commit('SET_ROLES', result.role)\n              commit('SET_INFO', result)\n            } else {\n              reject(new Error('getInfo: roles must be a non-null array !'))\n            }\n\n            commit('SET_NAME', { name: result.name, welcome: welcome() })\n            commit('SET_AVATAR', result.avatar)\n\n            resolve(response)\n          })\n          .catch(error => {\n            reject(error)\n          })\n      })\n    },\n\n    // 登出\n    // Logout ({ commit, state }) {\n    //   return new Promise(resolve => {\n    //     logout(state.token)\n    //       .then(() => {\n    //         resolve()\n    //       })\n    //       .catch(() => {\n    //         resolve()\n    //       })\n    //       .finally(() => {\n    //         commit('SET_TOKEN', '')\n    //         commit('SET_ROLES', [])\n    //         storage.remove(ACCESS_TOKEN)\n    //       })\n    //   })\n    // }\n\n    Logout ({ commit }) {\n        commit('SET_TOKEN', '')\n        commit('SET_ROLES', [])\n        storage.remove(ACCESS_TOKEN)\n    }\n\n  }\n}\n\nexport default user\n"]}]}