{"remainingRequest":"/Users/alone/VueProjects/one-piece-vue/node_modules/babel-loader/lib/index.js!/Users/alone/VueProjects/one-piece-vue/node_modules/eslint-loader/index.js??ref--13-0!/Users/alone/VueProjects/one-piece-vue/src/utils/request.js","dependencies":[{"path":"/Users/alone/VueProjects/one-piece-vue/src/utils/request.js","mtime":1595411171844},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/cache-loader/dist/cjs.js","mtime":1595422850119},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/babel-loader/lib/index.js","mtime":1595422850086},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/eslint-loader/index.js","mtime":1595422972371}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7IC8vIGltcG9ydCBzdG9yZSBmcm9tICdAL3N0b3JlJwoKaW1wb3J0IHN0b3JhZ2UgZnJvbSAnc3RvcmUnOwppbXBvcnQgbm90aWZpY2F0aW9uIGZyb20gJ2FudC1kZXNpZ24tdnVlL2VzL25vdGlmaWNhdGlvbic7CmltcG9ydCB7IFZ1ZUF4aW9zIH0gZnJvbSAnLi9heGlvcyc7CmltcG9ydCB7IEFDQ0VTU19UT0tFTiB9IGZyb20gJ0Avc3RvcmUvbXV0YXRpb24tdHlwZXMnOyAvLyDliJvlu7ogYXhpb3Mg5a6e5L6LCgp2YXIgcmVxdWVzdCA9IGF4aW9zLmNyZWF0ZSh7CiAgLy8gQVBJIOivt+axgueahOm7mOiupOWJjee8gAogIGJhc2VVUkw6IHByb2Nlc3MuZW52LlZVRV9BUFBfQVBJX0JBU0VfVVJMLAogIHRpbWVvdXQ6IDYwMDAgLy8g6K+35rGC6LaF5pe25pe26Ze0Cgp9KTsgLy8g5byC5bi45oum5oiq5aSE55CG5ZmoCgp2YXIgZXJyb3JIYW5kbGVyID0gZnVuY3Rpb24gZXJyb3JIYW5kbGVyKGVycm9yKSB7CiAgaWYgKGVycm9yLnJlc3BvbnNlKSB7CiAgICB2YXIgZGF0YSA9IGVycm9yLnJlc3BvbnNlLmRhdGE7IC8vIOS7jiBsb2NhbHN0b3JhZ2Ug6I635Y+WIHRva2VuCiAgICAvLyBjb25zdCB0b2tlbiA9IHN0b3JhZ2UuZ2V0KEFDQ0VTU19UT0tFTikKCiAgICBpZiAoZXJyb3IucmVzcG9uc2Uuc3RhdHVzID49IDMwMCkgewogICAgICBub3RpZmljYXRpb24uZXJyb3IoewogICAgICAgIG1lc3NhZ2U6ICfor7fmsYLplJnor68nLAogICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRhdGEubWVzc2FnZSB8fCBkYXRhLm1lc3NhZ2UKICAgICAgfSk7CiAgICB9IC8vIGlmIChlcnJvci5yZXNwb25zZS5zdGF0dXMgPT09IDQwMykgewogICAgLy8gICAgIG5vdGlmaWNhdGlvbi5lcnJvcih7CiAgICAvLyAgICAgICAgIG1lc3NhZ2U6ICdGb3JiaWRkZW4nLAogICAgLy8gICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5tZXNzYWdlCiAgICAvLyAgICAgfSkKICAgIC8vIH0KICAgIC8vIGlmIChlcnJvci5yZXNwb25zZS5zdGF0dXMgPT09IDQwMSAmJiAhKGRhdGEucmVzdWx0ICYmIGRhdGEucmVzdWx0LmlzTG9naW4pKSB7CiAgICAvLyAgICAgbm90aWZpY2F0aW9uLmVycm9yKHsKICAgIC8vICAgICAgICAgbWVzc2FnZTogJ1VuYXV0aG9yaXplZCcsCiAgICAvLyAgICAgICAgIGRlc2NyaXB0aW9uOiAnQXV0aG9yaXphdGlvbiB2ZXJpZmljYXRpb24gZmFpbGVkJwogICAgLy8gICAgIH0pCiAgICAvLyAgICAgaWYgKHRva2VuKSB7CiAgICAvLyAgICAgICAgIHN0b3JlLmRpc3BhdGNoKCdMb2dvdXQnKS50aGVuKCgpID0+IHsKICAgIC8vICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgLy8gICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKQogICAgLy8gICAgICAgICAgICAgfSwgMTUwMCkKICAgIC8vICAgICAgICAgfSkKICAgIC8vICAgICB9CiAgICAvLyB9CgogIH0KCiAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKfTsgLy8gcmVxdWVzdCBpbnRlcmNlcHRvcgoKCnJlcXVlc3QuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKGZ1bmN0aW9uIChjb25maWcpIHsKICB2YXIgdG9rZW4gPSBzdG9yYWdlLmdldChBQ0NFU1NfVE9LRU4pOyAvLyDlpoLmnpwgdG9rZW4g5a2Y5ZyoCiAgLy8g6K6p5q+P5Liq6K+35rGC5pC65bim6Ieq5a6a5LmJIHRva2VuIOivt+agueaNruWunumZheaDheWGteiHquihjOS/ruaUuQoKICBpZiAodG9rZW4pIHsKICAgIGNvbmZpZy5oZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICcgKyB0b2tlbjsKICB9CgogIHJldHVybiBjb25maWc7Cn0sIGVycm9ySGFuZGxlcik7IC8vIHJlc3BvbnNlIGludGVyY2VwdG9yCgpyZXF1ZXN0LmludGVyY2VwdG9ycy5yZXNwb25zZS51c2UoZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7Cn0sIGVycm9ySGFuZGxlcik7CnZhciBpbnN0YWxsZXIgPSB7CiAgdm06IHt9LAogIGluc3RhbGw6IGZ1bmN0aW9uIGluc3RhbGwoVnVlKSB7CiAgICBWdWUudXNlKFZ1ZUF4aW9zLCByZXF1ZXN0KTsKICB9Cn07CmV4cG9ydCBkZWZhdWx0IHJlcXVlc3Q7CmV4cG9ydCB7IGluc3RhbGxlciBhcyBWdWVBeGlvcywgcmVxdWVzdCBhcyBheGlvcyB9Ow=="},{"version":3,"sources":["/Users/alone/VueProjects/one-piece-vue/src/utils/request.js"],"names":["axios","storage","notification","VueAxios","ACCESS_TOKEN","request","create","baseURL","process","env","VUE_APP_API_BASE_URL","timeout","errorHandler","error","response","data","status","message","description","Promise","reject","interceptors","use","config","token","get","headers","installer","vm","install","Vue"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB,C,CACA;;AACA,OAAOC,OAAP,MAAoB,OAApB;AACA,OAAOC,YAAP,MAAyB,gCAAzB;AACA,SAASC,QAAT,QAAyB,SAAzB;AACA,SAASC,YAAT,QAA6B,wBAA7B,C,CAEA;;AACA,IAAMC,OAAO,GAAGL,KAAK,CAACM,MAAN,CAAa;AACzB;AACAC,EAAAA,OAAO,EAAEC,OAAO,CAACC,GAAR,CAAYC,oBAFI;AAGzBC,EAAAA,OAAO,EAAE,IAHgB,CAGX;;AAHW,CAAb,CAAhB,C,CAMA;;AACA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,KAAD,EAAW;AAC5B,MAAIA,KAAK,CAACC,QAAV,EAAoB;AAChB,QAAMC,IAAI,GAAGF,KAAK,CAACC,QAAN,CAAeC,IAA5B,CADgB,CAEhB;AACA;;AAEA,QAAIF,KAAK,CAACC,QAAN,CAAeE,MAAf,IAAyB,GAA7B,EAAkC;AAC9Bd,MAAAA,YAAY,CAACW,KAAb,CAAmB;AACfI,QAAAA,OAAO,EAAE,MADM;AAEfC,QAAAA,WAAW,EAAEH,IAAI,CAACA,IAAL,CAAUE,OAAV,IAAqBF,IAAI,CAACE;AAFxB,OAAnB;AAIH,KAVe,CAYhB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACH;;AACD,SAAOE,OAAO,CAACC,MAAR,CAAeP,KAAf,CAAP;AACH,CAlCD,C,CAoCA;;;AACAR,OAAO,CAACgB,YAAR,CAAqBhB,OAArB,CAA6BiB,GAA7B,CAAiC,UAAAC,MAAM,EAAI;AACvC,MAAMC,KAAK,GAAGvB,OAAO,CAACwB,GAAR,CAAYrB,YAAZ,CAAd,CADuC,CAEvC;AACA;;AACA,MAAIoB,KAAJ,EAAW;AACPD,IAAAA,MAAM,CAACG,OAAP,CAAe,eAAf,IAAkC,YAAYF,KAA9C;AACH;;AACD,SAAOD,MAAP;AACH,CARD,EAQGX,YARH,E,CAUA;;AACAP,OAAO,CAACgB,YAAR,CAAqBP,QAArB,CAA8BQ,GAA9B,CAAkC,UAACR,QAAD,EAAc;AAC5C,SAAOA,QAAQ,CAACC,IAAhB;AACH,CAFD,EAEGH,YAFH;AAIA,IAAMe,SAAS,GAAG;AACdC,EAAAA,EAAE,EAAE,EADU;AAEdC,EAAAA,OAFc,mBAELC,GAFK,EAEA;AACVA,IAAAA,GAAG,CAACR,GAAJ,CAAQnB,QAAR,EAAkBE,OAAlB;AACH;AAJa,CAAlB;AAOA,eAAeA,OAAf;AAEA,SACIsB,SAAS,IAAIxB,QADjB,EAEIE,OAAO,IAAIL,KAFf","sourcesContent":["import axios from 'axios'\n// import store from '@/store'\nimport storage from 'store'\nimport notification from 'ant-design-vue/es/notification'\nimport { VueAxios } from './axios'\nimport { ACCESS_TOKEN } from '@/store/mutation-types'\n\n// 创建 axios 实例\nconst request = axios.create({\n    // API 请求的默认前缀\n    baseURL: process.env.VUE_APP_API_BASE_URL,\n    timeout: 6000 // 请求超时时间\n})\n\n// 异常拦截处理器\nconst errorHandler = (error) => {\n    if (error.response) {\n        const data = error.response.data\n        // 从 localstorage 获取 token\n        // const token = storage.get(ACCESS_TOKEN)\n\n        if (error.response.status >= 300) {\n            notification.error({\n                message: '请求错误',\n                description: data.data.message || data.message\n            })\n        }\n\n        // if (error.response.status === 403) {\n        //     notification.error({\n        //         message: 'Forbidden',\n        //         description: data.message\n        //     })\n        // }\n        // if (error.response.status === 401 && !(data.result && data.result.isLogin)) {\n        //     notification.error({\n        //         message: 'Unauthorized',\n        //         description: 'Authorization verification failed'\n        //     })\n        //     if (token) {\n        //         store.dispatch('Logout').then(() => {\n        //             setTimeout(() => {\n        //                 window.location.reload()\n        //             }, 1500)\n        //         })\n        //     }\n        // }\n    }\n    return Promise.reject(error)\n}\n\n// request interceptor\nrequest.interceptors.request.use(config => {\n    const token = storage.get(ACCESS_TOKEN)\n    // 如果 token 存在\n    // 让每个请求携带自定义 token 请根据实际情况自行修改\n    if (token) {\n        config.headers['Authorization'] = 'Bearer ' + token\n    }\n    return config\n}, errorHandler)\n\n// response interceptor\nrequest.interceptors.response.use((response) => {\n    return response.data\n}, errorHandler)\n\nconst installer = {\n    vm: {},\n    install (Vue) {\n        Vue.use(VueAxios, request)\n    }\n}\n\nexport default request\n\nexport {\n    installer as VueAxios,\n    request as axios\n}\n"]}]}