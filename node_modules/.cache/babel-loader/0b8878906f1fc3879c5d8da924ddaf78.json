{"remainingRequest":"/Users/alone/VueProjects/one-piece-vue/node_modules/babel-loader/lib/index.js!/Users/alone/VueProjects/one-piece-vue/node_modules/eslint-loader/index.js??ref--13-0!/Users/alone/VueProjects/one-piece-vue/src/store/modules/user.js","dependencies":[{"path":"/Users/alone/VueProjects/one-piece-vue/src/store/modules/user.js","mtime":1596287714979},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/cache-loader/dist/cjs.js","mtime":1595422850119},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/babel-loader/lib/index.js","mtime":1595422850086},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/eslint-loader/index.js","mtime":1595422972371}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgc3RvcmFnZSBmcm9tICdzdG9yZSc7CmltcG9ydCB7IGxvZ2luLCBnZXRJbmZvIH0gZnJvbSAnQC9hcGkvbG9naW4nOwppbXBvcnQgeyBBQ0NFU1NfVE9LRU4gfSBmcm9tICdAL3N0b3JlL211dGF0aW9uLXR5cGVzJzsKaW1wb3J0IHsgd2VsY29tZSB9IGZyb20gJ0AvdXRpbHMvdXRpbCc7CnZhciB1c2VyID0gewogIHN0YXRlOiB7CiAgICB0b2tlbjogJycsCiAgICBuYW1lOiAnJywKICAgIHdlbGNvbWU6ICcnLAogICAgYXZhdGFyOiAnJywKICAgIHJvbGVzOiBbXSwKICAgIGluZm86IHt9LAogICAgcGVybWlzc2lvbnM6IFtdCiAgfSwKICBtdXRhdGlvbnM6IHsKICAgIFNFVF9UT0tFTjogZnVuY3Rpb24gU0VUX1RPS0VOKHN0YXRlLCB0b2tlbikgewogICAgICBzdGF0ZS50b2tlbiA9IHRva2VuOwogICAgfSwKICAgIFNFVF9OQU1FOiBmdW5jdGlvbiBTRVRfTkFNRShzdGF0ZSwgbmFtZSkgewogICAgICBzdGF0ZS5uYW1lID0gbmFtZTsKICAgIH0sCiAgICBTRVRfQVZBVEFSOiBmdW5jdGlvbiBTRVRfQVZBVEFSKHN0YXRlLCBhdmF0YXIpIHsKICAgICAgc3RhdGUuYXZhdGFyID0gYXZhdGFyOwogICAgfSwKICAgIFNFVF9ST0xFUzogZnVuY3Rpb24gU0VUX1JPTEVTKHN0YXRlLCByb2xlcykgewogICAgICBzdGF0ZS5yb2xlcyA9IHJvbGVzOwogICAgfSwKICAgIFNFVF9QRVJNSVNTSU9OUzogZnVuY3Rpb24gU0VUX1BFUk1JU1NJT05TKHN0YXRlLCBwZXJtaXNzaW9ucykgewogICAgICBzdGF0ZS5wZXJtaXNzaW9ucyA9IHBlcm1pc3Npb25zOwogICAgfSwKICAgIFNFVF9XRUxDT01FOiBmdW5jdGlvbiBTRVRfV0VMQ09NRShzdGF0ZSwgd2VsY29tZSkgewogICAgICBzdGF0ZS53ZWxjb21lID0gd2VsY29tZTsKICAgIH0sCiAgICBTRVRfSU5GTzogZnVuY3Rpb24gU0VUX0lORk8oc3RhdGUsIGluZm8pIHsKICAgICAgc3RhdGUuaW5mbyA9IGluZm87CiAgICB9CiAgfSwKICBhY3Rpb25zOiB7CiAgICAvLyDnmbvlvZUKICAgIExvZ2luOiBmdW5jdGlvbiBMb2dpbihfcmVmLCB1c2VySW5mbykgewogICAgICB2YXIgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgbG9naW4odXNlckluZm8pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICB2YXIgcmVzdWx0ID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgIHN0b3JhZ2Uuc2V0KEFDQ0VTU19UT0tFTiwgcmVzdWx0LmFjY2Vzc190b2tlbiwgcmVzdWx0LmV4cGlyZXNfaW4pOwogICAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCByZXN1bHQuYWNjZXNzX3Rva2VuKTsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOiOt+WPlueUqOaIt+S/oeaBrwogICAgR2V0SW5mbzogZnVuY3Rpb24gR2V0SW5mbyhfcmVmMikgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjIuY29tbWl0OwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIGdldEluZm8oKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgdmFyIHJlc3VsdCA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgICAgaWYgKHJlc3VsdC5wZXJtaXNzaW9ucy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHZhciBwZXJtaXNzaW9ucyA9IHJlc3VsdC5wZXJtaXNzaW9uczsKICAgICAgICAgICAgdmFyIHBlcm1pc3Npb25JZHMgPSBwZXJtaXNzaW9ucy5tYXAoZnVuY3Rpb24gKHBlcikgewogICAgICAgICAgICAgIGlmIChwZXIuYWN0aW9uRW50aXR5U2V0ICE9IG51bGwgJiYgcGVyLmFjdGlvbkVudGl0eVNldC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gcGVyLmFjdGlvbkVudGl0eVNldC5tYXAoZnVuY3Rpb24gKGFjdGlvbikgewogICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uLmFjdGlvbjsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcGVyLmFjdGlvbkxpc3QgPSBhY3Rpb247CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gcGVyLnBlcm1pc3Npb25JZDsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbW1pdCgnU0VUX1BFUk1JU1NJT05TJywgcGVybWlzc2lvbklkcyk7CiAgICAgICAgICAgIGNvbW1pdCgnU0VUX1JPTEVTJywgcmVzdWx0LnJvbGVzKTsKICAgICAgICAgICAgY29tbWl0KCdTRVRfSU5GTycsIHJlc3VsdCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdnZXRJbmZvOiBwZXJtaXNzaW9ucyBtdXN0IGJlIGEgbm9uLW51bGwgYXJyYXkgIScpKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb21taXQoJ1NFVF9OQU1FJywgcmVzdWx0Lm5pY2tuYW1lKTsKICAgICAgICAgIGNvbW1pdCgnU0VUX1dFTENPTUUnLCB3ZWxjb21lKCkpOwogICAgICAgICAgY29tbWl0KCdTRVRfQVZBVEFSJywgcmVzdWx0LmF2YXRhcik7CiAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOeZu+WHugogICAgLy8gTG9nb3V0ICh7IGNvbW1pdCwgc3RhdGUgfSkgewogICAgLy8gICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAvLyAgICAgbG9nb3V0KHN0YXRlLnRva2VuKQogICAgLy8gICAgICAgLnRoZW4oKCkgPT4gewogICAgLy8gICAgICAgICByZXNvbHZlKCkKICAgIC8vICAgICAgIH0pCiAgICAvLyAgICAgICAuY2F0Y2goKCkgPT4gewogICAgLy8gICAgICAgICByZXNvbHZlKCkKICAgIC8vICAgICAgIH0pCiAgICAvLyAgICAgICAuZmluYWxseSgoKSA9PiB7CiAgICAvLyAgICAgICAgIGNvbW1pdCgnU0VUX1RPS0VOJywgJycpCiAgICAvLyAgICAgICAgIGNvbW1pdCgnU0VUX1JPTEVTJywgW10pCiAgICAvLyAgICAgICAgIHN0b3JhZ2UucmVtb3ZlKEFDQ0VTU19UT0tFTikKICAgIC8vICAgICAgIH0pCiAgICAvLyAgIH0pCiAgICAvLyB9CiAgICBMb2dvdXQ6IGZ1bmN0aW9uIExvZ291dChfcmVmMykgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjMuY29tbWl0OwogICAgICBjb21taXQoJ1NFVF9UT0tFTicsICcnKTsKICAgICAgY29tbWl0KCdTRVRfUk9MRVMnLCBbXSk7CiAgICAgIGNvbW1pdCgnU0VUX1BFUk1JU1NJT05TJywgW10pOwogICAgICBzdG9yYWdlLnJlbW92ZShBQ0NFU1NfVE9LRU4pOwogICAgfQogIH0KfTsKZXhwb3J0IGRlZmF1bHQgdXNlcjs="},{"version":3,"sources":["/Users/alone/VueProjects/one-piece-vue/src/store/modules/user.js"],"names":["storage","login","getInfo","ACCESS_TOKEN","welcome","user","state","token","name","avatar","roles","info","permissions","mutations","SET_TOKEN","SET_NAME","SET_AVATAR","SET_ROLES","SET_PERMISSIONS","SET_WELCOME","SET_INFO","actions","Login","userInfo","commit","Promise","resolve","reject","then","response","result","data","set","access_token","expires_in","catch","error","GetInfo","length","permissionIds","map","per","actionEntitySet","action","actionList","permissionId","Error","nickname","Logout","remove"],"mappings":"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","sourcesContent":["import storage from 'store'\nimport {\n    login,\n    getInfo\n} from '@/api/login'\nimport {\n    ACCESS_TOKEN\n} from '@/store/mutation-types'\nimport {\n    welcome\n} from '@/utils/util'\n\nconst user = {\n    state: {\n        token: '',\n        name: '',\n        welcome: '',\n        avatar: '',\n        roles: [],\n        info: {},\n        permissions: []\n    },\n\n    mutations: {\n        SET_TOKEN: (state, token) => {\n            state.token = token\n        },\n        SET_NAME: (state, name) => {\n            state.name = name\n        },\n        SET_AVATAR: (state, avatar) => {\n            state.avatar = avatar\n        },\n        SET_ROLES: (state, roles) => {\n            state.roles = roles\n        },\n        SET_PERMISSIONS: (state, permissions) => {\n            state.permissions = permissions\n        },\n        SET_WELCOME: (state, welcome) => {\n            state.welcome = welcome\n        },\n        SET_INFO: (state, info) => {\n            state.info = info\n        }\n    },\n\n    actions: {\n        // 登录\n        Login({\n            commit\n        }, userInfo) {\n            return new Promise((resolve, reject) => {\n                login(userInfo)\n                    .then(response => {\n                        const result = response.data\n                        storage.set(ACCESS_TOKEN, result.access_token, result.expires_in)\n                        commit('SET_TOKEN', result.access_token)\n                        resolve()\n                    })\n                    .catch(error => {\n                        reject(error)\n                    })\n            })\n        },\n\n        // 获取用户信息\n        GetInfo({\n            commit\n        }) {\n            return new Promise((resolve, reject) => {\n                getInfo()\n                    .then(response => {\n                        const result = response.data\n\n                        if (result.permissions.length > 0) {\n                            const permissions = result.permissions\n\n                            const permissionIds = permissions.map(per => {\n                                if (per.actionEntitySet != null && per.actionEntitySet.length > 0) {\n                                    const action = per.actionEntitySet.map(action => {\n                                        return action.action\n                                    })\n                                    per.actionList = action\n                                }\n                                return per.permissionId\n                            })\n\n                            commit('SET_PERMISSIONS', permissionIds)\n                            commit('SET_ROLES', result.roles)\n                            commit('SET_INFO', result)\n                        } else {\n                            reject(new Error('getInfo: permissions must be a non-null array !'))\n                        }\n\n                        commit('SET_NAME', result.nickname)\n                        commit('SET_WELCOME', welcome())\n                        commit('SET_AVATAR', result.avatar)\n\n                        resolve(response)\n                    })\n                    .catch(error => {\n                        reject(error)\n                    })\n            })\n        },\n\n        // 登出\n        // Logout ({ commit, state }) {\n        //   return new Promise(resolve => {\n        //     logout(state.token)\n        //       .then(() => {\n        //         resolve()\n        //       })\n        //       .catch(() => {\n        //         resolve()\n        //       })\n        //       .finally(() => {\n        //         commit('SET_TOKEN', '')\n        //         commit('SET_ROLES', [])\n        //         storage.remove(ACCESS_TOKEN)\n        //       })\n        //   })\n        // }\n\n        Logout({\n            commit\n        }) {\n            commit('SET_TOKEN', '')\n            commit('SET_ROLES', [])\n            commit('SET_PERMISSIONS', [])\n            storage.remove(ACCESS_TOKEN)\n        }\n\n    }\n}\n\nexport default user\n"]}]}