{"remainingRequest":"/Users/alone/VueProjects/one-piece-vue/node_modules/babel-loader/lib/index.js!/Users/alone/VueProjects/one-piece-vue/node_modules/eslint-loader/index.js??ref--13-0!/Users/alone/VueProjects/one-piece-vue/src/utils/request.js","dependencies":[{"path":"/Users/alone/VueProjects/one-piece-vue/src/utils/request.js","mtime":1597417222900},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/cache-loader/dist/cjs.js","mtime":1595422850119},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/babel-loader/lib/index.js","mtime":1595422850086},{"path":"/Users/alone/VueProjects/one-piece-vue/node_modules/eslint-loader/index.js","mtime":1595422972371}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgc3RvcmUgZnJvbSAnQC9zdG9yZSc7CmltcG9ydCBzdG9yYWdlIGZyb20gJ3N0b3JlJzsKaW1wb3J0IG5vdGlmaWNhdGlvbiBmcm9tICdhbnQtZGVzaWduLXZ1ZS9lcy9ub3RpZmljYXRpb24nOwppbXBvcnQgeyBWdWVBeGlvcyB9IGZyb20gJy4vYXhpb3MnOwppbXBvcnQgeyBBQ0NFU1NfVE9LRU4gfSBmcm9tICdAL3N0b3JlL211dGF0aW9uLXR5cGVzJzsgLy8g5Yib5bu6IGF4aW9zIOWunuS+iwoKdmFyIHJlcXVlc3QgPSBheGlvcy5jcmVhdGUoewogIC8vIEFQSSDor7fmsYLnmoTpu5jorqTliY3nvIAKICBiYXNlVVJMOiBwcm9jZXNzLmVudi5WVUVfQVBQX0FQSV9CQVNFX1VSTCwKICB0aW1lb3V0OiA2MDAwIC8vIOivt+axgui2heaXtuaXtumXtAoKfSk7IC8vIOW8guW4uOaLpuaIquWkhOeQhuWZqAoKdmFyIGVycm9ySGFuZGxlciA9IGZ1bmN0aW9uIGVycm9ySGFuZGxlcihlcnJvcikgewogIGlmIChlcnJvci5yZXNwb25zZSkgewogICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UpOwogICAgdmFyIGRhdGEgPSBlcnJvci5yZXNwb25zZS5kYXRhOyAvLyDku44gbG9jYWxzdG9yYWdlIOiOt+WPliB0b2tlbgoKICAgIHZhciB0b2tlbiA9IHN0b3JhZ2UuZ2V0KEFDQ0VTU19UT0tFTik7CgogICAgaWYgKGVycm9yLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDAzKSB7CiAgICAgIG5vdGlmaWNhdGlvbi5lcnJvcih7CiAgICAgICAgbWVzc2FnZTogJ+emgeatouiuv+mXricsCiAgICAgICAgZGVzY3JpcHRpb246IGRhdGEubWVzc2FnZQogICAgICB9KTsKICAgIH0KCiAgICBpZiAoZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgbm90aWZpY2F0aW9uLmVycm9yKHsKICAgICAgICBtZXNzYWdlOiAn56aB5q2i6K6/6ZeuJywKICAgICAgICBkZXNjcmlwdGlvbjogJ+acquaOiOadg+eahOiuv+mXricKICAgICAgfSk7CgogICAgICBpZiAodG9rZW4pIHsKICAgICAgICBzdG9yZS5kaXNwYXRjaCgnTG9nb3V0JykudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOwogICAgICAgICAgfSwgMTUwMCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA0MjIpIHsKICAgICAgdmFyIGVycm9ycyA9IGRhdGEudmFsdWVzKCk7CiAgICAgIGNvbnNvbGUubG9nKCdkYXRhJywgZGF0YSk7CiAgICAgIGNvbnNvbGUubG9nKCdlcnInLCBlcnJvcnMpOwogICAgICBub3RpZmljYXRpb24uZXJyb3IoewogICAgICAgIG1lc3NhZ2U6ICfpqozor4HplJnor68nLAogICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhCiAgICAgIH0pOwogICAgfQoKICAgIGlmIChlcnJvci5yZXNwb25zZS5zdGF0dXMgPj0gMzAwKSB7CiAgICAgIG5vdGlmaWNhdGlvbi5lcnJvcih7CiAgICAgICAgbWVzc2FnZTogJ+ivt+axgumUmeivrycsCiAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGF0YS5tZXNzYWdlIHx8IGRhdGEubWVzc2FnZQogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7Cn07IC8vIHJlcXVlc3QgaW50ZXJjZXB0b3IKCgpyZXF1ZXN0LmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZShmdW5jdGlvbiAoY29uZmlnKSB7CiAgdmFyIHRva2VuID0gc3RvcmFnZS5nZXQoQUNDRVNTX1RPS0VOKTsgLy8g5aaC5p6cIHRva2VuIOWtmOWcqAogIC8vIOiuqeavj+S4quivt+axguaQuuW4puiHquWumuS5iSB0b2tlbiDor7fmoLnmja7lrp7pmYXmg4XlhrXoh6rooYzkv67mlLkKCiAgaWYgKHRva2VuKSB7CiAgICBjb25maWcuaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAnICsgdG9rZW47CiAgfQoKICByZXR1cm4gY29uZmlnOwp9LCBlcnJvckhhbmRsZXIpOyAvLyByZXNwb25zZSBpbnRlcmNlcHRvcgoKcmVxdWVzdC5pbnRlcmNlcHRvcnMucmVzcG9uc2UudXNlKGZ1bmN0aW9uIChyZXNwb25zZSkgewogIHJldHVybiByZXNwb25zZS5kYXRhOwp9LCBlcnJvckhhbmRsZXIpOwp2YXIgaW5zdGFsbGVyID0gewogIHZtOiB7fSwKICBpbnN0YWxsOiBmdW5jdGlvbiBpbnN0YWxsKFZ1ZSkgewogICAgVnVlLnVzZShWdWVBeGlvcywgcmVxdWVzdCk7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCByZXF1ZXN0OwpleHBvcnQgeyBpbnN0YWxsZXIgYXMgVnVlQXhpb3MsIHJlcXVlc3QgYXMgYXhpb3MgfTs="},{"version":3,"sources":["/Users/alone/VueProjects/one-piece-vue/src/utils/request.js"],"names":["axios","store","storage","notification","VueAxios","ACCESS_TOKEN","request","create","baseURL","process","env","VUE_APP_API_BASE_URL","timeout","errorHandler","error","response","console","log","data","token","get","status","message","description","dispatch","then","setTimeout","window","location","reload","errors","values","Promise","reject","interceptors","use","config","headers","installer","vm","install","Vue"],"mappings":"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","sourcesContent":["import axios from 'axios'\nimport store from '@/store'\nimport storage from 'store'\nimport notification from 'ant-design-vue/es/notification'\nimport { VueAxios } from './axios'\nimport { ACCESS_TOKEN } from '@/store/mutation-types'\n\n// 创建 axios 实例\nconst request = axios.create({\n    // API 请求的默认前缀\n    baseURL: process.env.VUE_APP_API_BASE_URL,\n    timeout: 6000 // 请求超时时间\n})\n\n// 异常拦截处理器\nconst errorHandler = (error) => {\n    if (error.response) {\n        console.log(error.response)\n        const data = error.response.data\n        // 从 localstorage 获取 token\n        const token = storage.get(ACCESS_TOKEN)\n\n        if (error.response.status === 403) {\n            notification.error({\n                message: '禁止访问',\n                description: data.message\n            })\n        }\n\n        if (error.response.status === 401) {\n            notification.error({\n                message: '禁止访问',\n                description: '未授权的访问'\n            })\n            if (token) {\n                store.dispatch('Logout').then(() => {\n                    setTimeout(() => {\n                        window.location.reload()\n                    }, 1500)\n                })\n            }\n        }\n\n        if (error.response.status === 422) {\n            const errors = data.values()\n\n            console.log('data', data)\n            console.log('err', errors)\n\n            notification.error({\n                message: '验证错误',\n                description: data\n            })\n        }\n\n        if (error.response.status >= 300) {\n            notification.error({\n                message: '请求错误',\n                description: data.data.message || data.message\n            })\n        }\n    }\n    return Promise.reject(error)\n}\n\n// request interceptor\nrequest.interceptors.request.use(config => {\n    const token = storage.get(ACCESS_TOKEN)\n    // 如果 token 存在\n    // 让每个请求携带自定义 token 请根据实际情况自行修改\n    if (token) {\n        config.headers['Authorization'] = 'Bearer ' + token\n    }\n    return config\n}, errorHandler)\n\n// response interceptor\nrequest.interceptors.response.use((response) => {\n    return response.data\n}, errorHandler)\n\nconst installer = {\n    vm: {},\n    install (Vue) {\n        Vue.use(VueAxios, request)\n    }\n}\n\nexport default request\n\nexport {\n    installer as VueAxios,\n    request as axios\n}\n"]}]}